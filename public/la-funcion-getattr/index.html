<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <!-- Meta information -->
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="author" content="Marcos Vanetta (malev)" />
  <meta name="description" content="Authorship and collaboration in open source projects"/>
  <!--Facebook meta -->
  <meta property="og:title" content="Marcos Alejandro Vanetta (malev)" />
  <meta property="og:description" content="Authorship and collaboration in open source projects" />
  <meta property="og:image" content="/images/malev_logo.png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- End of facebook meta -->

  <!-- syntax highlighting CSS -->
  <link rel="stylesheet" href="/css/syntax.css" type="text/css" />

  <!-- Homepage CSS -->
  <!-- <link rel="stylesheet" href="/css/bootstrap.css" type="text/css" media="screen, projection" /> -->
  <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="/css/bootstrap-responsive.min.css" type="text/css" media="screen, projection" />
  
  <!-- Google fonts -->
  <link href='http://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Ubuntu&v2' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Cabin+Sketch:700&v2' rel='stylesheet' type='text/css'>

  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<!--  <script src="/js/bootstrap.min.js"></script>-->
  <!--[if lt IE 9]>
  <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <title>La funciÃ³n getattr()</title>
</head>
<body>
<div class="container">
  <div class="site">
  <div id="post">
    <div class="title">
      <h1><a href='/#blog' name='blog'>Blog posts</a></h1>
    </div>
    <h1>La funciÃ³n getattr()</h1>

<p>Me encuentro haciendo un IRC bot [1] para el canal de #ubuntu-ar, el código fuente está aquí [2] y quiero extenderlo mediante plugins. Suena simple, pero no lo es para nada. Buscando como hacer semejante delirio descubrí el método getattr()[3]. Que según la documentación de python es:</p>

<blockquote>**getattr(objeto, nombre[,default])**: Devuelve el valor de un atributo de un objeto. Si la cadena es el nombre de uno de los atributos del objeto, el resultado será el valor del atributo. Si el nombre no existe, se devuelve "default" y de no estar definido, se levanta la excepción AttributeError.</blockquote>


<p>No entendi muy mucho, pero gracias a [4] y a [5] pude entender lo siguiente:</p>

<div class="highlight"><pre><code class="python"><span class="c"># Equivalentes</span>
<span class="kn">from</span> <span class="nn">string</span> <span class="kn">import</span> <span class="n">Formatter</span>
<span class="n">Formatter</span> <span class="c">#&lt;class &#39;string.Formatter&#39;&gt;</span>

<span class="kn">import</span> <span class="nn">string</span>
<span class="n">c</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="s">&#39;Formatter&#39;</span><span class="p">)</span>
<span class="n">c</span> <span class="c">#&lt;class &#39;string.Formatter&#39;&gt;</span>
</code></pre>
</div>


<p>Si son equivalentes, por qué molestarnos? Porque en el primer caso todo es estático, no se puede modificar en run time, mientras que en el segundo caso, como getattr toma como argumento cadenas, entonces se pueden modificar en tiempo de ejecición! ;)</p>

<div class="highlight"><pre><code class="python"><span class="c"># Seguimos investigando!</span>
<span class="c"># doc tendrá: &#39;len(object) -&gt; integer\n\nReturn the number ...</span>
<span class="n">doc</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="s">&quot;__doc__&quot;</span><span class="p">)</span>
<span class="c">#también se puede acceder a métodos:</span>
<span class="n">result</span> <span class="o">=</span> <span class="s">&quot;hola&quot;</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">)</span> <span class="c"># = 3</span>
<span class="n">result</span> <span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="s">&quot;hola&quot;</span><span class="p">,</span> <span class="s">&quot;find&quot;</span><span class="p">)(</span><span class="s">&quot;a&quot;</span><span class="p">)</span> <span class="c"># = 3</span>
<span class="c"># Previendo exceptions</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s">&quot;method&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="o">...</span> <span class="n">deal</span> <span class="k">with</span> <span class="n">missing</span> <span class="n">method</span> <span class="o">...</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<span class="c"># Solo ejecuta si existe el método</span>
<span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s">&quot;method&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="n">func</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</code></pre>
</div>


<p>Se que esto se usa para metaprogramación, pero todavía no lo entiendo bien, así que hasta ahí llego hoy.</p>

<p>[1] <a href="http://en.wikipedia.org/wiki/Internet_Relay_Chat_bot">http://en.wikipedia.org/wiki/Internet_Relay_Chat_bot</a>
[2] <a href="https://code.launchpad.net/~marcosvanetta/+junk/finop">finop</a>
[4] <a href="http://docs.python.org/library/functions.html#getattr">http://docs.python.org/library/functions.html#getattr</a>
[4] <a href="http://effbot.org/zone/python-getattr.htm">http://effbot.org/zone/python-getattr.htm</a>
[5] <a href="http://islascruz.org/html/index.php?Blog/SingleView/id/Piratearle-las-propiedades-a-un-objeto-en-Python">El blog de Marcos Islas</a>
<strong>Actualización!</strong> Lectura recomendada <a href="http://sydarex.org/repository/papers/py_dmlfd/py_dmlfd.html">http://sydarex.org/repository/papers/py_dmlfd/py_dmlfd.html</a></p>

    
      <div class="comments" style="margin-top: 20px;">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'malevsblog'; // required: replace example with your forum shortname

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
      </div>
    
  </div>
  <div id="related">
    <h2><a href='/about.html'>About the author</a></h2>
  </div>

  <div id="related">
    <h2>Related Posts</h2>
    <ul class="posts">
      
        <li><span>01 Jun 2012</span> &raquo; <a href="/backbone-first-steps">Learning Javascript</a></li>
      
        <li><span>13 Apr 2012</span> &raquo; <a href="/nginx-passenger-and-php">Nginx, passenger and PHP</a></li>
      
        <li><span>09 Apr 2012</span> &raquo; <a href="/learning-javascript">Learning Javascript</a></li>
      
    </ul>
  </div>
</div>
  <div class="site">
    <div class="footer">
      <div class="contact">
        <p style="margin:0;">
          <a href="/about.html">Marcos Vanetta</a> <strong>(malev)</strong><br />
          Software engineer<br />
          <a href="http://github.com/malev/">github</a> | <a href="http://twitter.com/malev/">twitter</a> | <a href="http://launchpad.net/~marcosvanetta">Launchpad</a>
        </p>
      </div>
      <div class="rss">
        <a href="http://feeds.feedburner.com/malev">
          <img src="/images/rss-logo.png" alt="Subscribe to RSS Feed" style="width: 64px;"/>
        </a>
      </div>
    </div>
  </div>
</div>
<a href="http://github.com/malev"><img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" /></a>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-29516046-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>
