<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <!-- Meta information -->
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="author" content="Marcos Vanetta (malev)" />
  <meta name="description" content="Authorship and collaboration in open source projects"/>
  <!--Facebook meta -->
  <meta property="og:title" content="Marcos Alejandro Vanetta (malev)" />
  <meta property="og:description" content="Authorship and collaboration in open source projects" />
  <meta property="og:image" content="/images/malev_logo.png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- End of facebook meta -->

  <!-- syntax highlighting CSS -->
  <link rel="stylesheet" href="/css/syntax.css" type="text/css" />

  <!-- Homepage CSS -->
  <!-- <link rel="stylesheet" href="/css/bootstrap.css" type="text/css" media="screen, projection" /> -->
  <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="/css/bootstrap-responsive.min.css" type="text/css" media="screen, projection" />
  
  <!-- Google fonts -->
  <link href='http://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Ubuntu&v2' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Cabin+Sketch:700&v2' rel='stylesheet' type='text/css'>

  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<!--  <script src="/js/bootstrap.min.js"></script>-->
  <!--[if lt IE 9]>
  <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <title>getter and setters in ruby</title>
</head>
<body>
<div class="container">
  <div class="site">
  <div id="post">
    <div class="title">
      <h1><a href='/#blog' name='blog'>Blog posts</a></h1>
    </div>
    <h1>getter and setters in ruby</h1>

<p>Una de las primeras definiciones de que es un objeto que escuche fue:
Un objeto se define como la unidad que en tiempo de ejecución realiza las tareas de un programa. Cada objeto es capaz de recibir mensajes, procesar datos y enviar mensajes. Los objetos tienen 3 características: identidad, comportamiento y estado.
No voy a discutir sobre la definición de los objetos este post. <strong>Me voy a enfocar en la última característica: el estado, que viene dado por los atributos de un objeto</strong>. Vamos a definir una clase con algunos atributos <em>"old school"</em>:</p>

<div class="highlight"><pre><code class="ruby"><span class="k">class</span> <span class="nc">Coordinates</span>
  <span class="k">def</span> <span class="nf">set_x</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="vi">@x</span> <span class="o">=</span> <span class="n">x</span>
  <span class="k">end</span>
  
  <span class="k">def</span> <span class="nf">set_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="vi">@y</span> <span class="o">=</span> <span class="n">y</span>
  <span class="k">end</span>
  
  <span class="k">def</span> <span class="nf">get_x</span>
    <span class="k">return</span> <span class="vi">@x</span>
  <span class="k">end</span>
  
  <span class="k">def</span> <span class="nf">get_y</span>
   <span class="k">return</span> <span class="vi">@y</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">coord</span> <span class="o">=</span> <span class="no">Coordinates</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">set_x</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">set_y</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">#{</span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre>
</div>


<p>El código funciona, pero no se ve muy "lindo", como diría Roberto en [1], <em>eso es C++ disfrazado de Ruby</em> (el en realidad hablaría de python, pero no creo que se enoje). Usando un poquito más las ventajas que nos ofrece ruby, podríamos, mejorar los métodos "set_x" y "set_y" usando la característica de Ruby de dejarnos usar el signo "=" en el nombre del método, más o menos así: <strong>"get_x="</strong> y <strong>"get_y="</strong>, como para tener un código mucho más legible. Pero aprovechando un poco más la magia de ruby, vamos a omitir los métodos set_x y set_y:</p>

<div class="highlight"><pre><code class="ruby"><span class="k">class</span> <span class="nc">Coordinates2</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="vi">@x</span><span class="p">,</span> <span class="vi">@y</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">get_x</span>
    <span class="k">return</span> <span class="vi">@x</span>
  <span class="k">end</span>
  
  <span class="k">def</span> <span class="nf">get_y</span>
   <span class="k">return</span> <span class="vi">@y</span>
  <span class="k">end</span>
<span class="k">end</span>  

<span class="n">coord2</span> <span class="o">=</span> <span class="no">Coordinates2</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">coord2</span><span class="o">.</span><span class="n">get_x</span><span class="si">}</span><span class="s2">, </span><span class="si">#{</span><span class="n">coord2</span><span class="o">.</span><span class="n">get_y</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre>
</div>


<p>Mejoró un poco, pero todavía le falta bastante. Por supuesto, podríamos omitir la keyword "<strong>return</strong>" y dejar solo el "@x" o "@y" ya que ruby devuelve por defecto el última código ejecutado en cada método. Igual sigue siendo mucho código para tan poco.
Ruby nos ofrece un lindo atajo: "<strong>attr_reader</strong>":</p>

<div class="highlight"><pre><code class="ruby"><span class="k">class</span> <span class="nc">Coordinates3</span>
  <span class="kp">attr_reader</span> <span class="ss">:y</span><span class="p">,</span> <span class="ss">:x</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="vi">@x</span><span class="p">,</span> <span class="vi">@y</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">coord3</span> <span class="o">=</span> <span class="no">Coordinates3</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">coord3</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">#{</span><span class="n">coord3</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre>
</div>


<p>Como vemos estamos usando símbolos [2] para indicar que atributos pueden ser leidos desde el exterior. Ahora que pasa si en algún momento de la ejecución también queremos cambiar alguno de estos atributos?. Una solución es definir un método de escritura como en nuestro primer ejemplo o podemos usar el hermano de <strong>attr_reader</strong>: <strong>attr_accessor</strong>:</p>

<div class="highlight"><pre><code class="ruby"><span class="k">class</span> <span class="nc">Coordinates4</span>
  <span class="kp">attr_accessor</span> <span class="ss">:y</span><span class="p">,</span> <span class="ss">:x</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="vi">@x</span><span class="p">,</span> <span class="vi">@y</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">coord4</span> <span class="o">=</span> <span class="no">Coordinates4</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">coord4</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">#{</span><span class="n">coord4</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">coord4</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">coord4</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
<span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">coord4</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">#{</span><span class="n">coord4</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre>
</div>


<p>Y por último vemos: <strong>attr_writer</strong>, que nos deja escribir un atributo pero no leerlo:</p>

<div class="highlight"><pre><code class="ruby"><span class="k">class</span> <span class="nc">Coordinates5</span>
  <span class="kp">attr_accessor</span> <span class="ss">:x</span>
  <span class="kp">attr_writer</span> <span class="ss">:y</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="vi">@x</span><span class="p">,</span> <span class="vi">@y</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="n">coord5</span> <span class="o">=</span> <span class="no">Coordinates5</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">coord5</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">coord5</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">10</span>
<span class="c1"># this last command fails</span>
<span class="nb">puts</span> <span class="n">coord5</span><span class="o">.</span><span class="n">y</span>
</code></pre>
</div>


<p>Listo por ahora. En otro post voy a cubrir: <strong>virtual attributes</strong>, <strong>attr_accessible</strong> y <strong>attr_protected</strong>. Los últimos 2 exclusivos de Rails.</p>

<p>[1] http://nomuerde.netmanagers.com.ar/1.html
[2] http://blog.malev.com.ar/2009/10/02/los-simbolos-en-ruby-symbol/</p>

    
      <div class="comments" style="margin-top: 20px;">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'malevsblog'; // required: replace example with your forum shortname

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
      </div>
    
  </div>
  <div id="related">
    <h2><a href='/about.html'>About the author</a></h2>
  </div>

  <div id="related">
    <h2>Related Posts</h2>
    <ul class="posts">
      
        <li><span>01 Jun 2012</span> &raquo; <a href="/backbone-first-steps">Learning Javascript</a></li>
      
        <li><span>13 Apr 2012</span> &raquo; <a href="/nginx-passenger-and-php">Nginx, passenger and PHP</a></li>
      
        <li><span>09 Apr 2012</span> &raquo; <a href="/learning-javascript">Learning Javascript</a></li>
      
    </ul>
  </div>
</div>
  <div class="site">
    <div class="footer">
      <div class="contact">
        <p style="margin:0;">
          <a href="/about.html">Marcos Vanetta</a> <strong>(malev)</strong><br />
          Software engineer<br />
          <a href="http://github.com/malev/">github</a> | <a href="http://twitter.com/malev/">twitter</a> | <a href="http://launchpad.net/~marcosvanetta">Launchpad</a>
        </p>
      </div>
      <div class="rss">
        <a href="http://feeds.feedburner.com/malev">
          <img src="/images/rss-logo.png" alt="Subscribe to RSS Feed" style="width: 64px;"/>
        </a>
      </div>
    </div>
  </div>
</div>
<a href="http://github.com/malev"><img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" /></a>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-29516046-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>
